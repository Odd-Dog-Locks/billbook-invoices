<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Locksmith Bill Book</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Bill Book">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%1e40af'/><text y='60' font-size='50' text-anchor='middle' x='50' fill='white'>Bill</text></svg>">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<style>
    @media print {
        @page { margin: 8mm; size: A4 portrait; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; background: white; }
        #controls, #modeToggleContainer, #signatureModal, #historyView, #tabBill, #tabHistory, .no-print { display: none !important; }
        #billView, #bill { display: block !important; box-shadow: none !important; border-radius: 0 !important; width: 210mm !important; min-height: 297mm !important; margin: 0 !important; }
        .preserve { white-space: pre-line !important; display: block !important; border: 1px solid #d1d5db !important; border-radius: 0.375rem !important; padding: 0.5rem !important; font-size: 0.875rem !important; margin-top: 0.25rem !important; }
        textarea { display: none !important; }
        h1 { font-size: 22pt !important; }
    }
    .preserve { white-space: pre-line; display: none; }
    #signatureCanvas { touch-action: none; }
</style>
</head>
<body class="bg-gray-100 min-h-screen">

<!-- FULL HTML STRUCTURE (no JS needed to render) -->
<div id="app" class="max-w-4xl mx-auto p-4">

    <div class="flex border-b mb-6">
        <button id="tabBill" class="px-6 py-3 font-bold text-blue-600 border-b-4 border-blue-600">New Bill</button>
        <button id="tabHistory" class="px-6 py-3 font-bold text-gray-600">History (<span id="historyCount">0</span>)</button>
    </div>

    <div id="billView">
        <div id="controls" class="mb-5 flex flex-wrap items-center justify-between gap-4 no-print">
            <div class="flex gap-3">
                <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 px-6 rounded-lg shadow print-btn">Print</button>
                <button class="bg-green-600 hover:bg-green-700 text-white font-bold py-2.5 px-6 rounded-lg shadow pdf-btn">Save PDF</button>
                <button class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2.5 px-5 rounded-lg shadow new-btn">New</button>
            </div>
            <div class="flex items-center gap-3 bg-gray-200 rounded-full p-1.5">
                <span class="px-4 text-sm font-medium text-gray-600">NSP</span>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="modeToggle" class="sr-only peer" checked>
                    <div class="w-14 h-8 bg-gray-400 rounded-full peer-checked:bg-blue-600 transition"></div>
                    <div class="absolute left-1 top-1
